<script type="text/javascript">
    /*global App */
    App.page_stock_calc_abc = {
	parsed: true,
	init: function () {
	    this.node.window({
		title: 'Расчет Классов',
		width: 570,
		top: 50,
		height: 'auto',
		shadow: false,
		onClose: function () {
		    delete App.page_stock_calc_abc;
		    pickmeup('.three-calendars').destroy();
		}
	    });
	    this.node.window('hcenter');
	    this.node.window('window').css('position', 'fixed');

	    $("#stock_calc_abc_label").html(this.data.parent_label || "Все");
	    App.setupForm("#page_stock_calc_abc_frm", {}, "use_inp_values");
	    
	    App.require(['js/pickmeup/pickmeup.min.js','js/pickmeup/pickmeup.css'],function(){
		App.page_stock_calc_abc.rangePicker();
	    });
	    
	},
	submit: function (e) {
	    e.preventDefault();
	    var fvalue = App.collectForm("#page_stock_calc_min_frm");
	    fvalue.reserve_period = fvalue.reserve_period1 * 1 + fvalue.reserve_period2 * 1;
	    this.handler.notify('submit', fvalue);
	    this.node.window('window', 'close');
	},
	rangePicker: function () {
	    pickmeup.defaults.locales['ru'] = {
		    days: ['Воскресенье', 'Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница', 'Суббота'],
		    daysShort: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],
		    daysMin: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],
		    months: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
		    monthsShort: ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек']
	    };
	    var idate = new Date;
	    idate.setMonth(idate.getMonth() -3);
	    pickmeup('.three-calendars', {
		locale    : 'ru',
		format	  : 'd.m.Y',
		flat      : false,
		date      : [idate,new Date],
		mode      : 'range',
		calendars : 2,
		position  : 'bottom',
		hide_on_select : true,
		render : function (date) {
		    var now = new Date;
		    if (date > now) {
			return {disabled : true};
		    }
		    return {};
		} 
	    });
	}
    };
</script>
<style>
    #page_stock_calc_abc_frm .inp_group b{
	width:120px;
    }
    .daterangepicker{
	z-index: 10000;
    }
</style>
<form id="page_stock_calc_abc_frm" onsubmit="App.page_stock_calc_abc.submit(event)">
    <img src="img/calc.png" style="float:left" /> 
    <p style="padding: 5px">
    <big>Классификация по продаваемости товаров категории:"<b id="stock_calc_abc_label"></b>"</big><br>
    A - 80% продаж<br>
    B - 15% продаж<br>
    C - 5% продаж<br>
    </p>
    <input type="checkbox" title="Все наши фирмы" name="all_active" checked="checked" />
    <input class="three-calendars" title="Период рассчета">
    <div style="text-align: center;margin-top: 15px;">
	<button type="submit"><img src="img/calc.png" style="width:24px;height: 24px;" /> Рассчитать</button>
	<button type="button" onclick="App.page_stock_calc_min.node.window('close')"><img src="img/close24.png" /> Закрыть</button>
    </div>
</form>
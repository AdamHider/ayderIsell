<script>
    (function($){
	var supplylist;
	function init(){
	    initTable();
	}
	function initTable(){
	    function dateFormatter(row, cell, value, columnDef, dataContext){
		var date_parts=value.split(' ')[0].split('-');
		var date=date_parts[2]+'.'+date_parts[1]+'.'+date_parts[0];
		return '<span title="'+value.split(' ')[1]+'">'+date+'</span>';
	    }
	    function tooltip(row, cell, value, columnDef, dataContext){
		if( !value ){
		    return '';
		}
		var parts = value.split(' ');
		var cmd = parts.shift();
		if (cmd){
		    var style='max-width:16px;height:auto';
		    return '<img src="img/' + cmd + '.png" style="'+style+'" title="' + parts.join(' ') + '">';
		}
		else{
		    return '';
		}	    
	    }
	    var settings={
		columns:[
		    {id:"pcomp_label", field: "pcomp_label",name: "Контрагент", width: 120 },
		    {id:"doc_type_icon", field: "doc_type_icon",name: "", width: 25,formatter:tooltip},
		    {id:"cstamp", field: "cstamp",name: "Дата",  width: 70, sortable: true,formatter:dateFormatter },
		    {id:"doc_num", field: "doc_num",name: "Номер", width: 50, sortable: true,cssClass:'slick-align-right' },
		    {id:"doc_total", field: "doc_total",name: "Сумма", width: 70, sortable: true },
		    {id:"trans_status", field: "trans_status",name: "Оплачен", width: 25, sortable: true,formatter:tooltip},
		    {id:"is_commited", field: "is_commited",name: "Проведен", width: 25,formatter:tooltip},
		    {id:"doc_type_name", field: "doc_type_name",name: "Тип документа", sortable: true, width: 150 },
		    {id:"views", field: "views",name: "Напечатано", width: 70}

		],
		options:{
		    enableCellNavigation: true,
		    enableColumnReorder: false,
		    enableFilter:true,
		    multiSelect :true,
		    url:'DocumentList/listFetch'
		}
	    };
	    var h = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
	    $("#supplylist_sg").css('height',(h-$("#supplylist_sg").position().top-30)+'px');
	    $("#supplylist_sg_tools .icon-refresh").click(function(){
		supplylist.reload();
	    });
	    supplylist=$("#supplylist_sg").slickgrid(settings);
	}
	App.require([
	    "js/slick/lib/jquery.event.drag-2.3.0.js",
	    "js/slick/slick.core.js",
	    "js/slick/slick.grid.js",
	    "js/slick/plugins/slick.rowselectionmodel.js",
	    "js/slick/slick.editors.js",
	    "js/slick/slickwrapper.js"
	],init);
    })(jQuery);
</script>
<div>
    <div id="supplylist_sg_tools" class="transp60">
	<div style="float: left;font-weight: bold;padding-top: 8px;">
	    <img src="img/table16.png" style="width:16px;height: 16px;"> Документы
	</div>
	<div style="float: right">
	    <span class="icon-24 icon-refresh" title="Обновить"> </span> 
	</div>
    </div>
    <div id="supplylist_sg" style="width:100%;height:700px;"></div>
</div>
<script>
    (function($){
	var supplylist;
	function init(){
	    initTable();
	}
	function initTable(){
	    function dateFormatter(row, cell, value, columnDef, dataContext){
		var date_parts=value.split(' ')[0].split('-');
		var date=date_parts[2]+'.'+date_parts[1]+'.'+date_parts[0];
		return '<span title="'+value.split(' ')[1]+'">'+date+'</span>';
	    }
	    function tooltip(row, cell, value, columnDef, dataContext){
		if( !value ){
		    return '';
		}
		var parts = value.split(' ');
		var cmd = parts.shift();
		if (cmd){
		    var style='max-width:16px;height:auto';
		    return '<img src="img/' + cmd + '.png" style="'+style+'" title="' + parts.join(' ') + '">';
		}
		else{
		    return '';
		}
	    }	    
	    var settings={
		columns:[
		    {id:"supplier_company", field: "supplier_company",name: "Поставщик", width: 70 },
		    {id:"product_code", field: "product_code",name: "Код", width: 50, sortable: true},
		    {id:"supply_code", field: "supply_code",name: "Код поставщика",  width: 50, sortable: true},
		    {id:"supply_name", field: "supply_name",name: "Название поставщика", width: 200, sortable: true },
		    {id:"supply_buy", field: "supply_buy",name: "Закупка", width: 30, sortable: true,cssClass:'slick-align-right' },
		    {id:"supply_self", field: "supply_self",name: "Себестоимость", width: 30, sortable: true,cssClass:'slick-align-right'},
		    {id:"supply_comment", field: "supply_comment",name: "Комментарий", width: 150},
		    {id:"supply_modified", field: "supply_modified",name: "Изменено", sortable: true, width: 30 },
		    {id:"supply_spack", field: "supply_spack",name: "В Коробке", sortable: true, width: 30 },
		    {id:"supply_bpack", field: "supply_bpack",name: "В Ящике", sortable: true, width: 30 },
		    {id:"supply_volume", field: "supply_volume",name: "Объем", sortable: true, width: 30 },
		    {id:"supply_weight", field: "supply_weight",name: "Вес", sortable: true, width: 30 },
		    {id:"supply_unit", field: "supply_unit",name: "Единица", sortable: true, width: 30}
		],
		options:{
		    enableCellNavigation: true,
		    enableColumnReorder: false,
		    enableFilter:true,
		    multiSelect :true,
		    url:'StockBuyManager/listFetch'
		}
	    };
	    var h = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
	    $("#supplylist_sg").css('height',(h-$("#supplylist_sg").position().top-30)+'px');
	    $("#supplylist_sg_tools .icon-refresh").click(function(){
		supplylist.reload();
	    });
	    supplylist=$("#supplylist_sg").slickgrid(settings);
	}
	App.require([
	    "js/slick/lib/jquery.event.drag-2.3.0.js",
	    "js/slick/slick.core.js",
	    "js/slick/slick.grid.js",
	    "js/slick/plugins/slick.rowselectionmodel.js",
	    "js/slick/slick.editors.js",
	    "js/slick/slickwrapper.js"
	],init);
    })(jQuery);
</script>
<div>
    <div id="supplylist_sg_tools" class="transp60">
	<div style="float: left;font-weight: bold;padding-top: 8px;">
	    <img src="img/table16.png" style="width:16px;height: 16px;"> Документы
	</div>
	<div style="float: right">
	    <span class="icon-24 icon-refresh" title="Обновить"> </span> 
	</div>
    </div>
    <div id="supplylist_sg" style="width:100%;height:700px;"></div>
</div>